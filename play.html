<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Video Player</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0px;
        }

        .jwplayer {
            position: absolute !important;
        }

        .jwplayer.jw-flag-aspect-mode {
            min-height: 100%;
            max-height: 100%;
        }
    </style>
</head>
<body>
<div id="jwplayerDiv"></div>
<script src="//content.jwplatform.com/libraries/SAHhwvZq.js"></script>
<script type="text/javascript">
    // Function to fetch JSON data from URL
    async function fetchJson(url) {
        const response = await fetch(url);
        return await response.json();
    }

    // Function to setup JWPlayer with video data
    function setupPlayer(videoData) {
        jwplayer("jwplayerDiv").setup({
            file: videoData.manifest_url+"?begin=20240525T010000&end=20240531T160000",
            position: 'bottom',
            autostart: true,
            stretching: "",
            width: "100%",
            type: "dash",
            drm: {
                widevine: {
                    url: "https://universe-cors.deno.dev/"+videoData.license_url,
                    headers: videoData.manifest_headers || {},
                    keyId: videoData.clearkeys.keyId,
                    key: videoData.clearkeys.key
                }
            }
        });
    }

    // Function to get URL parameter by name
    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    // Fetch JSON data from the provided URL
    fetchJson("https://universe-cors.deno.dev/https://universe-channels.deno.dev/")
        .then(data => {
            // Sample JSON data (replace with fetched data)
            const channels = data.data.channels;
            // Get the ID parameter from the URL
            const videoId = getParameterByName('id');

            // Find the video data based on the ID
            const videoData = channels.find(channel => channel.id === videoId);

            if (videoData) {
                // Setup JWPlayer with video data
                setupPlayer(videoData);
            } else {
                // If video data not found, display an error message or handle as needed
                console.error('Video not found!');
            }
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });
</script>
</body>
</html>
